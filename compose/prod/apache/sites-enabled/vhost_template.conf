<VirtualHost *:$SERVICE_PORT>
    UseCanonicalName On
    ServerName https://$SERVICE_NAME.dcc.ac.uk
    # DocumentRoot ${SRC_ROOT}/${SERVICE_NAME}/public
    
    <Location />
        require all granted
    </Location>

    # Exclude certain urls from being passed to puma server
    # ProxyPass /javascripts !
    # ProxyPass /stylesheets !
    # ProxyPass /images !
    # ProxyPass /fonts !
    # ProxyPass /system !

    ProxyPass /Shibboleth.sso !

    # Everything else gets passed through to puma
    ProxyPass / http://${SERVICE_NAME}_app:$PUMA_PORT/
    ProxyPassReverse / http://${SERVICE_NAME}_app:$PUMA_PORT/

    LogLevel info
    ErrorLog "$BASE_LOG_DIR/${SERVICE_NAME}/error_log"
    CustomLog "$BASE_LOG_DIR/${SERVICE_NAME}/access_log" common
</VirtualHost>




